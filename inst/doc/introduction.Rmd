---
title: "Introduction to ddhw"
author: "N. Ignatiadis"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{"Introduction to ddhw"}
  %\VignetteEngine{knitr::rmarkdown}
  %\usepackage[utf8]{inputenc}
---


```{r}
library("DESeq2")
```

```{r}
library("airway")
data("airway")
dds <- DESeqDataSet(se = airway, design = ~ cell + dex)
dds <- DESeq(dds)
dds <- results(dds)
dds <-subset(dds, !is.na(pvalue))
```

First we perform our ddhw-testing procedure using the MILP formulation:
```{r}
library("ddhw")
res_milp <- ddhw(dds$pvalue,dds$baseMean, 10, 0.1)
weights(res_milp)
sum(adj_pvalues(res_milp) < 0.1)
```

Using the derivative-free optimization method:
```{r}
res_subplex <- ddhw(dds$pvalue,dds$baseMean, 10, 0.1, optim_method="subplex")
weights(res_subplex)
sum(adj_pvalues(res_subplex) < 0.1)
```

Compare these results to the standard BH procedure:
```{r}
sum(p.adjust(dds$pvalue, method="BH") < 0.1)
```
